# 쏙쏙 들어오는 함수형 코딩 5장 5장: 더 좋은 액션만들기

### 핵심 개념 요약

함수형 프로그래밍의 가장 중요한 원칙 중 하나는 **액션(Action)**, **계산(Calculation)**, **데이터(Data)**를 명확히 구분하는 것입니다. 5장에서는 이 세 가지 요소를 더 효과적으로 설계하고 개선하는 방법을 다룹니다.

### 액션(Action) 개선하기

액션은 실행 시점과 횟수에 따라 결과가 달라질 수 있는 함수나 연산을 말합니다.

#### 액션을 개선하는 방법:

1. **암묵적 입력과 출력 줄이기**

   - 액션이 사용하는 모든 입력과 출력을 명시적으로 만들기
   - 전역 변수 사용 최소화하기
   - 함수의 인자로 모든 필요한 값을 전달하기

2. **액션을 계산으로 변환하기**

   - 가능한 경우, 액션을 순수 함수(계산)로 리팩토링하기
   - 예: 데이터베이스 조회 함수 → 데이터베이스 연결을 인자로 받는 순수 함수

3. **액션을 최대한 작게 만들기**
   - 하나의 액션은 하나의 책임만 가지도록 분리하기
   - 복잡한 액션을 여러 개의 작은 액션으로 나누기

### 계산(Calculation) 개선하기

계산은 같은 입력에 대해 항상 같은 출력을 반환하는 순수 함수입니다.

#### 계산을 개선하는 방법:

1. **계산에서 모든 암묵적 입력과 출력 제거하기**

   - 전역 상태에 의존하지 않도록 수정하기
   - 부수 효과(side effects) 제거하기

2. **작은 계산으로 분리하기**

   - 복잡한 계산을 더 작고 이해하기 쉬운 여러 계산으로 나누기
   - 각 계산 함수는 한 가지 일만 하도록 설계하기

3. **일급 추상화로 만들기**
   - 함수를 값으로 다루어 고차 함수 활용하기
   - 콜백, 함수 합성 등의 기법 활용하기

### 데이터(Data) 개선하기

데이터는 정보를 표현하는 불변의 값입니다.

#### 데이터를 개선하는 방법:

1. **중첩된 데이터 구조 단순화하기**

   - 복잡한 중첩 구조 대신 평평한(flat) 구조 사용하기
   - 데이터 정규화를 통해 중복 제거하기

2. **일관된 데이터 구조 사용하기**

   - 유사한 데이터는 같은 형태의 구조로 표현하기
   - 코드 전반에 걸쳐 일관된 네이밍과 구조 유지하기

3. **불변성(Immutability) 유지하기**
   - 데이터를 변경하는 대신 새로운 데이터를 생성하기
   - 원본 데이터를 보존하여 예측 가능성 높이기

### 실전 적용: 쇼핑 카트 예제

#### 개선 전:

```javascript
// 액션과 계산이 섞여 있는 코드
function updateShoppingCart() {
  let total = 0;
  for (let i = 0; i < cart.length; i++) {
    const item = cart[i];
    total += item.price * item.quantity;
    updateItemDisplay(item); // 액션
  }
  updateTotalDisplay(total); // 액션
}
```

#### 개선 후:

```javascript
// 계산과 액션 분리
// 계산: 총액 계산하기
function calculateTotal(cart) {
  return cart.reduce((total, item) => total + item.price * item.quantity, 0);
}

// 계산: 각 아이템의 소계 계산하기
function calculateItemSubtotal(item) {
  return item.price * item.quantity;
}

// 액션: UI 업데이트하기
function updateCartDisplay(cart) {
  const total = calculateTotal(cart);
  cart.forEach((item) => {
    const subtotal = calculateItemSubtotal(item);
    renderItemRow(item, subtotal); // 작은 액션
  });
  renderTotalRow(total); // 작은 액션
}
```

### 핵심 원칙 정리

1. **"코드 냄새"를 감지하고 개선하기**

   - 암묵적 입출력이 많은 함수
   - 너무 큰 함수 (많은 일을 하는 함수)
   - 중첩이 깊은 데이터 구조

2. **함수형 설계의 핵심 패턴**

   - 입력과 출력을 명시적으로 만들기
   - 작은 함수로 분리하기
   - 액션, 계산, 데이터 영역 명확히 구분하기
   - 불변성 유지하기

3. **함수형 프로그래밍의 장점**
   - 테스트 용이성 증가
   - 코드 이해도 향상
   - 재사용성 증가
   - 버그 발생 가능성 감소

### 실천 방법

1. 기존 코드에서 액션, 계산, 데이터를 식별해보기
2. 액션 내부에 있는 계산 부분을 분리해보기
3. 계산 함수들이 순수한지 확인하기
4. 데이터 구조를 단순화하고 일관성 있게 만들기
5. 작은 단위로 리팩토링하며 테스트 작성하기

함수형 프로그래밍은 한 번에 완벽하게 적용하기보다 **점진적으로 코드를 개선**해나가는 과정
