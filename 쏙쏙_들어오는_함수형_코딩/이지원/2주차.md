
# 쏙쏙 들어오는 함수형 코딩 - 4장 액션에서 계산 빼내기

## 📌 함수는 입력과 출력이 있다

- **입력**은 함수가 어떤 계산을 하기 위해 필요한 외부 정보
- **출력**은 함수가 밖으로 내보내는 정보, 또는 외부에 끼치는 영향
- 함수는 **결과를 얻기 위해 호출**되는 것이고 결과를 내려면 입력이 필요하다

하지만 입력과 출력은 항상 명시적인 것은 아니다.

---

### ❗ 암묵적 입력과 출력이란?

|유형|예시|설명|
|---|---|---|
|**암묵적 입력**|전역변수 읽기|인자 없이 외부 상태를 참조|
|**암묵적 출력**|전역변수 변경, 콘솔 출력, DOM 조작 등|함수 외부 세계에 영향을 끼침|

> 암묵적인 입력/출력은 결국 모두 **부수효과(side effect)** 다.

---

## 🔁 리팩터링: 암묵적 부수효과를 제거하기

함수형 프로그래밍은 부수효과를 완전히 없애는 것이 아니라,  
**“계산”과 “부수효과(액션)”를 구분하여 격리**하는 방향으로 설계한다.

그 과정에서 우리는 다음의 리팩터링 기법을 사용할 수 있다:

1. **암묵적 입력 → 함수 인자로 바꾸기**
2. **암묵적 출력 → 함수 리턴값으로 바꾸기**
3. DOM 조작, 네트워크 요청 등은 **계산 밖으로 격리**
    

---

## 🛒 예시: 장바구니에 상품 담기

### ❌ 기존 코드 – 암묵적 입력과 출력이 섞여 있는 구조

```javascript
let cart = [];

function addItemToCart(item) {
  cart.push(item);               // 전역 상태 직접 변경 (암묵적 입력/출력)
  updateCartUI();                // DOM 조작 (암묵적 출력)
}

function updateCartUI() {
  const cartElement = document.getElementById('cart');
  cartElement.innerText = `총 ${cart.length}개 상품`;
}
```

- `cart`는 전역변수 → 함수 밖 상태에 직접 의존
- `updateCartUI`는 DOM 조작 → 부수효과
- 테스트, 추론, 유지보수가 어렵다

---

### ✅ 함수형 스타일로 리팩터링

```javascript
// 계산 함수: 새로운 cart 반환
function addItem(cart, item) {
  return [...cart, item]; // 불변성을 유지하며 새로운 배열 생성
}

// 액션 함수: DOM 반영 (격리된 부수효과)
function renderCartCount(cart) {
  const cartElement = document.getElementById('cart');
  cartElement.innerText = `총 ${cart.length}개 상품`;
}

// 실행 흐름
let cart = [];

const newItem = { id: 1, name: '무선 마우스', price: 29000 };

cart = addItem(cart, newItem);   // 계산
renderCartCount(cart);           // 액션
```

---

## ✅ 이렇게 리팩터링하면 좋은 점

- `addItem()`은 **순수 함수**로서, 같은 입력이면 항상 같은 출력 → 테스트가 쉬움
- `renderCartCount()`는 명시적으로 **부수효과만 처리**
- 상태 변경과 UI 업데이트가 분리되어 **코드 의도 파악이 쉬움**
- 상태는 불변성을 유지하며, 외부와 독립적으로 관리됨

---

## ✨ 인사이트

『쏙쏙 들어오는 함수형 코딩』 4장에서는  
**암묵적인 입력/출력을 줄이고 명시적으로 바꾸는 것이 곧 `계산`으로의 전환**이라고 말한다.

> 계산은 입력과 출력이 명확하고 예측 가능하며 테스트가 가능하다.  
> 반면 액션(부수효과)은 실행 시점과 횟수에 의존하고 외부 세계에 영향을 끼친다.

React의 함수형 컴포넌트도 마찬가지다.  
불변 상태 관리(useState), 계산용 훅(useMemo), 부수효과 관리(useEffect) 등  
부수효과를 격리하고 통제하려는 방향성을 따른다.